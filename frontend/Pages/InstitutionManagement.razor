@page "/InstitutionManagement/"


<div class="UserContainer">
    <div class="UserView">
        <div class="Btn">
            <button @onclick="CreateInstitution">Create institution</button>
        </div>
        <div class="Table">
            <TableTemplate Items="institutions" Context="institution">
                <TableHeader>
                    <th>Institution</th>
                    <th>Admin</th>
                    <th>Edit</th>
                </TableHeader>
                <RowTemplate>
                    <td>@institution.Navn</td>
                    <td>@institution.Admin</td>
                    <td><a href="/InstitutionManagement/" @onclick="EditInstitution">Edit</a></td>
                </RowTemplate>
            </TableTemplate>
        </div>
    </div>

    <div class="UserManagement">
        @if (CurrentMode == Mode.Initial)
        {
            <h1>Test</h1>
        }
        else if (CurrentMode == Mode.Edit)
        {
            <EditInstitution OnAddInstitutionCallback="@test_inst.Add"></EditInstitution>;
            CurrentMode = Mode.Initial;
        }
        else if (CurrentMode == Mode.Create)
        {
            <CreateInstitution OnAddInstitutionCallback="@institutions.Add"></CreateInstitution>
            CurrentMode = Mode.Initial;
        }
    </div>
</div>

@code
{
    public List<Institution> institutions = new List<Institution>();
    public List<Institution> test_inst = new List<Institution>();

    Mode CurrentMode { get; set; } = Mode.Initial;
    enum Mode
    {
        Initial,
        Edit,
        Create
    }

    public void EditValues(Institution Institution)
    {
        int index = institutions.FindIndex(item => item.Navn == "test");
        if (index >= 0) 
        {
            Console.WriteLine("bang");
            institutions[index].Navn = "GAMING?";
        }
    }

    private void CreateInstitution()
    {
        CurrentMode = Mode.Create;
    }

    private void EditInstitution()
    {
        CurrentMode = Mode.Edit;
        
    }
}