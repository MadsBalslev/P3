@page "/PosterManagement"
@using MudBlazor
@inject ISnackbar Snackbar
@using frontend.Shared.Manager

<MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6">
    <MudTabPanel Text="Posters">
        <Manager T="@Poster" ApiPath="/Posters" Context="poster" Filter="FilterFunc">
            <HeaderContent>
                <MudTh>
                    <MudTableSortLabel T=@Poster SortBy="(x) => x.id">ID</MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel T=@Poster SortBy="(x) => x.name">Name
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel T=@Poster SortBy="(x) => x.startDate">Start date
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel T=@Poster SortBy="(x) => x.endDate">End date
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel T=@Poster SortBy="(x) => x.createdBy.name">Creator
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel T=@Poster SortBy="(x) => x.institution.name">Institution
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel T=@Poster SortBy="(x) => x.image">Image url
                    </MudTableSortLabel>
                </MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd>@poster.id</MudTd>
                <MudTd>@poster.name</MudTd>
                <MudTd>@poster.startDate</MudTd>
                <MudTd>@poster.endDate</MudTd>
                <MudTd>@poster.createdBy.name</MudTd>
                <MudTd>@poster.institution.name</MudTd>
                <MudTd>@poster.image</MudTd>
            </RowTemplate>
            <CreateForm>
                <PosterCreateForm />
            </CreateForm>
            <EditForm>
                <PosterEditForm />
            </EditForm>
        </Manager>
    </MudTabPanel>
    <MudTabPanel Text="Poster Schedules">
    </MudTabPanel>
</MudTabs>

@code
{
    private bool FilterFunc(Poster poster, string searchString)
    {
        if (string.IsNullOrWhiteSpace(searchString))
            return true;
        if (poster.id.ToString().Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (poster.name.Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (poster.startDate.ToString().Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (poster.endDate.ToString().Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (poster.createdBy.name.Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (poster.institution.name.Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        if (poster.image.Contains(searchString, StringComparison.OrdinalIgnoreCase))
            return true;
        return false;
    }
}
